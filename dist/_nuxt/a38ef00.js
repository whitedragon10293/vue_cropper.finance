(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1236:function(e,n,t){"use strict";(function(e){t.d(n,"b",(function(){return k})),t.d(n,"c",(function(){return v})),t.d(n,"h",(function(){return j})),t.d(n,"f",(function(){return W})),t.d(n,"d",(function(){return T})),t.d(n,"g",(function(){return I})),t.d(n,"a",(function(){return B})),t.d(n,"e",(function(){return R}));t(71),t(50),t(80),t(59),t(49),t(77),t(81),t(64);var r=t(85),o=t(9),c=(t(40),t(642),t(31),t(110),t(405),t(89),t(11)),l=t(3),d=t(5),m=t(169),f=t(0),w=t(19),y=t(16),O=t(4),S=t(120);function A(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return x(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==t.return||t.return()}finally{if(l)throw o}}}}function x(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,t=new Array(n);i<n;i++)t[i]=e[i];return t}function k(e,n,t,r,o,c,l){var d=parseFloat(c),m=r,w=o;return m===f.b.mintAddress&&(m=f.c.WSOL.mintAddress),w===f.b.mintAddress&&(w=f.c.WSOL.mintAddress),m===e.quoteMintAddress.toBase58()&&w===e.baseMintAddress.toBase58()?function(e,n,t,r){var o,c=0,l=null,d=0,m=t,f=A(n.items(!1));try{for(f.s();!(o=f.n()).done;){var w=o.value,y=w.key,O=w.quantity,S=(null==e?void 0:e.priceLotsToNumber(y.ushrn(64)))||0,x=(null==e?void 0:e.baseSizeLotsToNumber(O))||0;l||0===S||(l=S);var k=S*x;if(d=S,k>=m){c+=m/S,m=0;break}c+=x,m-=k}}catch(e){f.e(e)}finally{f.f()}var v=(d-l)/l*100;return{side:"buy",maxInAllow:t-m,amountOut:c*=.993,amountOutWithSlippage:c*(100-r)/100,worstPrice:d=d*(100+r)/100,priceImpact:v}}(e,n,d,l):function(e,n,t,r){var o,c=0,l=null,d=0,m=t,f=A(n.items(!0));try{for(f.s();!(o=f.n()).done;){var w=o.value,y=w.key,O=w.quantity,S=e.priceLotsToNumber(y.ushrn(64))||0,x=(null==e?void 0:e.baseSizeLotsToNumber(O))||0;if(l||0===S||(l=S),d=S,m<=x){c+=m*S,m=0;break}c+=S*x,m-=x}}catch(e){f.e(e)}finally{f.f()}var k=(l-d)/l*100;return{side:"sell",maxInAllow:t-m,amountOut:c*=.993,amountOutWithSlippage:c*(100-r)/100,worstPrice:d=d*(100-r)/100,priceImpact:k}}(e,t,d,l)}function v(e,n,t,r,o){var c=e.coin,l=e.pc,d=e.fees,m=d.swapFeeNumerator,f=d.swapFeeDenominator;if(n===c.mintAddress&&t===l.mintAddress){var w=new y.a(r,c.decimals,!1),O=c.balance.wei.plus(w.wei),S=l.balance.wei.multipliedBy(w.wei).dividedBy(O),A=S.dividedBy(f).multipliedBy(f-m),x=A.dividedBy(1+o/100),k=l.balance.wei.minus(S),v=new y.a(parseFloat(new y.a(l.balance.wei,l.decimals).fixed())/parseFloat(new y.a(c.balance.wei,c.decimals).fixed()),l.decimals,!1),j=new y.a(parseFloat(new y.a(k,l.decimals).fixed())/parseFloat(new y.a(O,c.decimals).fixed()),l.decimals,!1),h=(parseFloat(v.fixed())-parseFloat(j.fixed()))/parseFloat(v.fixed())*100;return{amountIn:w,amountOut:new y.a(A,l.decimals),amountOutWithSlippage:new y.a(x,l.decimals),priceImpact:h}}var W=new y.a(r,l.decimals,!1),P=l.balance.wei.plus(W.wei),T=c.balance.wei.multipliedBy(W.wei).dividedBy(P),F=T.dividedBy(f).multipliedBy(f-m),K=F.dividedBy(1+o/100),I=c.balance.wei.minus(T),L=new y.a(parseFloat(new y.a(l.balance.wei,l.decimals).fixed())/parseFloat(new y.a(c.balance.wei,c.decimals).fixed()),l.decimals,!1),B=new y.a(parseFloat(new y.a(P,l.decimals).fixed())/parseFloat(new y.a(I,c.decimals).fixed()),l.decimals,!1),M=(parseFloat(B.fixed())-parseFloat(L.fixed()))/parseFloat(L.fixed())*100;return{amountIn:W,amountOut:new y.a(F,c.decimals),amountOutWithSlippage:new y.a(K,c.decimals),priceImpact:M}}function j(e,n,t,r,o,c,l,d){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(regeneratorRuntime.mark((function e(n,t,r,o,d,m,O,S){var A,x,k,v,j,h,W,P,T,address,F;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A=new l.Transaction,x=[],k=r.publicKey,v=Object(f.e)(o),j=new y.a(S,null==v?void 0:v.decimals,!1),e.next=7,Object(w.e)(m,k,o,A);case 7:return h=e.sent,e.next=10,Object(w.e)(O,k,d,A);case 10:return W=e.sent,e.next=13,n.post("https://swap.sollet.io/api/swap_to",{address:W.toString(),blockchain:"sol",coin:d,size:1,wusdtToUsdt:!0});case 13:if(P=e.sent,T=P.result,address=T.address,F=T.maxSize,address){e.next=17;break}throw new Error("Unwrap not available now");case 17:if(!(parseFloat(S)>F)){e.next=19;break}throw new Error("Max allow ".concat(F));case 19:return A.add(I(h,new l.PublicKey(address),k,Object(c.c)(j.toWei()))),A.add(L(W.toString())),e.next=23,Object(w.o)(t,r,A,x);case 23:return e.abrupt("return",e.sent);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e,n,t,r,o,c,l,d,m){return P.apply(this,arguments)}function P(){return(P=Object(o.a)(regeneratorRuntime.mark((function e(n,t,r,o,d,m,O,A,x){var k,v,j,h,W,P,T,F,I,L,B,M,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k=new l.Transaction,v=[],j=t.publicKey,h=Object(f.e)(o),W=Object(f.e)(d),h&&W){e.next=7;break}throw new Error("Miss token info");case 7:if(P=new y.a(A,h.decimals,!1),T=new y.a(x,W.decimals,!1),I=d,(F=o)===f.b.mintAddress&&(F=f.c.WSOL.mintAddress),I===f.b.mintAddress&&(I=f.c.WSOL.mintAddress),L=null,B=null,o!==f.b.mintAddress){e.next=19;break}return e.next=18,Object(w.g)(n,L,j,f.c.WSOL.mintAddress,Object(c.c)(P.wei)+1e7,k,v);case 18:L=e.sent;case 19:if(d!==f.b.mintAddress){e.next=23;break}return e.next=22,Object(w.g)(n,B,j,f.c.WSOL.mintAddress,1e7,k,v);case 22:B=e.sent;case 23:return e.next=25,Object(w.e)(m,j,F,k);case 25:return M=e.sent,e.next=28,Object(w.e)(O,j,I,k);case 28:return R=e.sent,k.add(K(new l.PublicKey(r.programId),new l.PublicKey(r.ammId),new l.PublicKey(r.ammAuthority),new l.PublicKey(r.ammOpenOrders),new l.PublicKey(r.ammTargetOrders),new l.PublicKey(r.poolCoinTokenAccount),new l.PublicKey(r.poolPcTokenAccount),new l.PublicKey(r.serumProgramId),new l.PublicKey(r.serumMarket),new l.PublicKey(r.serumBids),new l.PublicKey(r.serumAsks),new l.PublicKey(r.serumEventQueue),new l.PublicKey(r.serumCoinVaultAccount),new l.PublicKey(r.serumPcVaultAccount),new l.PublicKey(r.serumVaultSigner),null!=L?L:M,null!=B?B:R,j,Math.floor(Object(c.c)(P.toWei())),Math.floor(Object(c.c)(T.toWei())))),L&&k.add(Object(S.closeAccount)({source:L,destination:j,owner:j})),B&&k.add(Object(S.closeAccount)({source:B,destination:j,owner:j})),e.next=34,Object(w.o)(n,t,k,v);case 34:return e.abrupt("return",e.sent);case 35:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,n,t,r,o,c,l,d,m,f,w){return F.apply(this,arguments)}function F(){return(F=Object(o.a)(regeneratorRuntime.mark((function e(n,t,o,d,y,A,x,v,j,h,W){var P,T,F,K,I,L,B,M,R,N,z,E,_,U,V,C,D,J;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P=k(o,d,y,A,x,h,W),T=new l.Transaction,F=[],K=t.publicKey,e.next=6,o.findOpenOrdersAccountsForOwner(n,K,0);case 6:return I=e.sent,e.next=9,Object(w.f)(n,0===I.length?null:I[0].address.toBase58(),K,new l.PublicKey(O.q),null,m._OPEN_ORDERS_LAYOUT_V2,T,F);case 9:if(L=e.sent,B=null,A!==f.b.mintAddress){e.next=17;break}return"buy"===P.side?(M=Math.round(P.worstPrice*P.amountOut*1.01*l.LAMPORTS_PER_SOL),I.length>0&&(M-=Object(c.c)(I[0].quoteTokenFree))):(M=Math.round(P.maxInAllow*l.LAMPORTS_PER_SOL),I.length>0&&(M-=Object(c.c)(I[0].baseTokenFree))),M=Math.max(M,0)+1e7,e.next=16,Object(w.g)(n,B,K,f.c.WSOL.mintAddress,M,T,F);case 16:B=e.sent;case 17:return T.add(o.makePlaceOrderInstruction(n,{owner:K,payer:null!=B?B:new l.PublicKey(v),side:P.side,price:P.worstPrice,size:"buy"===P.side?parseFloat(P.amountOut.toFixed(6)):parseFloat(P.maxInAllow.toFixed(6)),orderType:"ioc",openOrdersAddressKey:L})),B&&T.add(Object(S.closeAccount)({source:B,destination:K,owner:K})),N=x,(R=A)===f.b.mintAddress&&(R=f.c.WSOL.mintAddress),N===f.b.mintAddress&&(N=f.c.WSOL.mintAddress),e.next=25,Object(w.e)(v,K,R,T);case 25:return z=e.sent,e.next=28,Object(w.e)(j,K,N,T);case 28:return E=e.sent,_=[z,E],o.baseMintAddress.toBase58()===N&&o.quoteMintAddress.toBase58()===R&&_.reverse(),U=_[0],V=_[1],C=null,o.supportsReferralFees&&(null==(D=Object(f.e)(o.quoteMintAddress.toBase58()))?void 0:D.referrer)&&(C=new l.PublicKey(null==D?void 0:D.referrer)),e.next=37,o.makeSettleFundsTransaction(n,new m.OpenOrders(L,{owner:K},new l.PublicKey(O.q)),U,V,C);case 37:return J=e.sent,e.next=40,Object(w.o)(n,t,Object(w.n)([T,J.transaction]),[].concat(F,Object(r.a)(J.signers)));case 40:return e.abrupt("return",e.sent);case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(n,t,r,o,c,m,f,w,y,S,A,x,k,v,j,h,W,P,T,F){var K=Object(d.struct)([Object(d.u8)("instruction"),Object(d.nu64)("amountIn"),Object(d.nu64)("minAmountOut")]),I=[{pubkey:O.x,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:j,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:W,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!0,isWritable:!0}],data=e.alloc(K.span);return K.encode({instruction:9,amountIn:T,minAmountOut:F},data),new l.TransactionInstruction({keys:I,programId:n,data:data})}function I(source,n,t,r){var o=Object(d.struct)([Object(d.u8)("instruction"),Object(d.nu64)("amount")]),c=[{pubkey:source,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!0,isWritable:!1}],data=e.alloc(o.span);return o.encode({instruction:3,amount:r},data),new l.TransactionInstruction({keys:c,programId:O.x,data:data})}function L(n){return new l.TransactionInstruction({keys:[],data:e.from(n,"utf-8"),programId:O.l})}function B(e,n,t){return M.apply(this,arguments)}function M(){return(M=Object(o.a)(regeneratorRuntime.mark((function e(n,t,r){var o,c,l,d,m,w,y,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(l=t.publicKey){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,null==r?void 0:r.findOpenOrdersAccountsForOwner(n,l,1e3);case 7:if(null==(d=e.sent)?void 0:d.length){e.next=10;break}return e.abrupt("return");case 10:return m=r.baseSplSizeToNumber(d[0].baseTokenTotal),w=r.quoteSplSizeToNumber(d[0].quoteTokenTotal),y=r.baseSplSizeToNumber(d[0].baseTokenFree),O=r.quoteSplSizeToNumber(d[0].quoteTokenFree),e.abrupt("return",{baseSymbol:null===(o=Object(f.e)(r.baseMintAddress.toString()))||void 0===o?void 0:o.symbol,quoteSymbol:null===(c=Object(f.e)(r.quoteMintAddress.toString()))||void 0===c?void 0:c.symbol,baseTotalAmount:m,quoteTotalAmount:w,baseUnsettledAmount:y,quoteUnsettledAmount:O,openOrders:d[0]});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,n,t,r,o,c,l,d){return N.apply(this,arguments)}function N(){return(N=Object(o.a)(regeneratorRuntime.mark((function e(n,t,o,c,d,m,y,O){var A,x,k,v,j,h,W,P,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A=new l.Transaction,x=[],k=c.publicKey,d!==f.c.WSOL.mintAddress){e.next=7;break}return e.next=6,Object(w.g)(n,v,k,f.c.WSOL.mintAddress,1e7,A,x);case 6:v=e.sent;case 7:if(m!==f.c.WSOL.mintAddress){e.next=11;break}return e.next=10,Object(w.g)(n,j,k,f.c.WSOL.mintAddress,1e7,A,x);case 10:j=e.sent;case 11:return h=Object(f.e)(m),e.next=14,t.makeSettleFundsTransaction(n,o,null!=v?v:new l.PublicKey(y),null!=j?j:new l.PublicKey(O),h&&h.referrer?new l.PublicKey(h.referrer):null);case 14:return W=e.sent,P=W.transaction,T=W.signers,v&&P.add(Object(S.closeAccount)({source:v,destination:k,owner:k})),j&&P.add(Object(S.closeAccount)({source:j,destination:k,owner:k})),e.next=21,Object(w.o)(n,c,Object(w.n)([A,P]),[].concat(x,Object(r.a)(T)));case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,t(12).Buffer)}}]);